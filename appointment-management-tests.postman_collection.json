{
  "info": {
    "_postman_id": "f3a9d58c-e1f7-43b9-a8c6-f35e7319b284",
    "name": "8Senses Appointment Management",
    "description": "API collection for testing appointment management features",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Admin Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "",
                  "if (jsonData.success === true) {",
                  "    pm.environment.set(\"adminToken\", jsonData.token);",
                  "    pm.test(\"Admin token saved to environment\", function() {",
                  "        pm.expect(pm.environment.get(\"adminToken\")).to.not.be.undefined;",
                  "    });",
                  "} else {",
                  "    pm.test(\"Login failed\", function() {",
                  "        pm.expect(jsonData.success).to.be.true;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"admin@example.com\",\n    \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "login"]
            },
            "description": "Login as admin to get authentication token"
          },
          "response": []
        },
        {
          "name": "Therapist Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "",
                  "if (jsonData.success === true) {",
                  "    pm.environment.set(\"therapistToken\", jsonData.token);",
                  "    pm.test(\"Therapist token saved to environment\", function() {",
                  "        pm.expect(pm.environment.get(\"therapistToken\")).to.not.be.undefined;",
                  "    });",
                  "} else {",
                  "    pm.test(\"Login failed\", function() {",
                  "        pm.expect(jsonData.success).to.be.true;",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"email\": \"therapist@example.com\",\n    \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["api", "auth", "login"]
            },
            "description": "Login as therapist to get authentication token"
          },
          "response": []
        }
      ],
      "description": "Authentication endpoints for getting tokens"
    },
    {
      "name": "Public Appointment Endpoints",
      "item": [
        {
          "name": "Submit Public Appointment Request",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "",
                  "if (jsonData.success === true && jsonData.reference) {",
                  "    pm.environment.set(\"publicAppointmentId\", jsonData.reference);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"fullName\": \"Jane Smith\",\n    \"email\": \"jane.smith@example.com\",\n    \"phone\": \"+919876543210\",\n    \"dateTime\": \"2023-12-15T10:00:00\",\n    \"reason\": \"Speech therapy evaluation for my child\",\n    \"serviceType\": \"Speech Therapy\",\n    \"specialist\": \"Any speech therapist\",\n    \"consultationMode\": \"in-person\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/appointments/public",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "public"]
            },
            "description": "Submit a public appointment request without requiring authentication"
          },
          "response": []
        },
        {
          "name": "Check Public Appointment Status",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/appointments/public/status/{{publicAppointmentId}}",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "appointments",
                "public",
                "status",
                "{{publicAppointmentId}}"
              ]
            },
            "description": "Check the status of a previously submitted public appointment request"
          },
          "response": []
        }
      ],
      "description": "Endpoints that are accessible without authentication"
    },
    {
      "name": "Admin & Receptionist Endpoints",
      "item": [
        {
          "name": "Get All Appointments",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/appointments",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments"]
            },
            "description": "Get all appointments (admin/receptionist only)"
          },
          "response": []
        },
        {
          "name": "Get All Appointments with Filters",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/appointments?status=scheduled&startDate=2023-12-01&endDate=2023-12-31",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments"],
              "query": [
                {
                  "key": "status",
                  "value": "scheduled"
                },
                {
                  "key": "startDate",
                  "value": "2023-12-01"
                },
                {
                  "key": "endDate",
                  "value": "2023-12-31"
                }
              ]
            },
            "description": "Get appointments with specific filters"
          },
          "response": []
        },
        {
          "name": "Get Public Appointment Requests",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/appointments/public-requests",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "public-requests"]
            },
            "description": "Get all pending public appointment requests"
          },
          "response": []
        },
        {
          "name": "Create Appointment",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var jsonData = pm.response.json();",
                  "",
                  "if (jsonData.success === true && jsonData.data && jsonData.data._id) {",
                  "    pm.environment.set(\"appointmentId\", jsonData.data._id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"fullName\": \"John Doe\",\n    \"email\": \"john.doe@example.com\",\n    \"phone\": \"+919876543210\",\n    \"therapistId\": \"{{therapistId}}\",\n    \"serviceId\": \"{{serviceId}}\",\n    \"date\": \"2023-12-15\",\n    \"startTime\": \"10:00\",\n    \"endTime\": \"11:00\",\n    \"type\": \"initial assessment\",\n    \"notes\": \"Initial consultation for speech therapy\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/appointments",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments"]
            },
            "description": "Create a new appointment (admin/receptionist only)"
          },
          "response": []
        },
        {
          "name": "Get Appointment by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/appointments/{{appointmentId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "{{appointmentId}}"]
            },
            "description": "Get details of a specific appointment"
          },
          "response": []
        },
        {
          "name": "Update Appointment",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"notes\": \"Updated notes for the appointment\",\n    \"date\": \"2023-12-16\",\n    \"startTime\": \"11:00\",\n    \"endTime\": \"12:00\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/appointments/{{appointmentId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "{{appointmentId}}"]
            },
            "description": "Update an existing appointment"
          },
          "response": []
        },
        {
          "name": "Update Appointment Status",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"status\": \"completed\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/appointments/{{appointmentId}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "{{appointmentId}}", "status"]
            },
            "description": "Update an appointment's status"
          },
          "response": []
        },
        {
          "name": "Reschedule Appointment",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"date\": \"2023-12-20\",\n    \"startTime\": \"14:00\",\n    \"endTime\": \"15:00\",\n    \"reason\": \"Patient requested a different time\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/appointments/{{appointmentId}}/reschedule",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "{{appointmentId}}", "reschedule"]
            },
            "description": "Reschedule an appointment to a different date/time"
          },
          "response": []
        },
        {
          "name": "Convert Public Request to Formal Appointment",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"therapistId\": \"{{therapistId}}\",\n    \"serviceId\": \"{{serviceId}}\",\n    \"date\": \"2023-12-18\",\n    \"startTime\": \"09:00\",\n    \"endTime\": \"10:00\",\n    \"appointmentType\": \"initial assessment\",\n    \"paymentAmount\": 1200\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/appointments/{{publicAppointmentId}}/convert-public-request",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "appointments",
                "{{publicAppointmentId}}",
                "convert-public-request"
              ]
            },
            "description": "Convert a public appointment request into a formal appointment"
          },
          "response": []
        },
        {
          "name": "Assign Therapist to Appointment",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"therapistId\": \"{{therapistId}}\",\n    \"date\": \"2023-12-20\",\n    \"startTime\": \"15:00\",\n    \"endTime\": \"16:00\",\n    \"appointmentType\": \"initial assessment\",\n    \"serviceId\": \"{{serviceId}}\",\n    \"paymentAmount\": 1500\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/appointments/{{publicAppointmentId}}/assign-therapist",
              "host": ["{{baseUrl}}"],
              "path": [
                "api",
                "appointments",
                "{{publicAppointmentId}}",
                "assign-therapist"
              ]
            },
            "description": "Assign a therapist to a pending appointment request"
          },
          "response": []
        },
        {
          "name": "Delete Appointment",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/appointments/{{appointmentId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "{{appointmentId}}"]
            },
            "description": "Delete an appointment (admin/receptionist only)"
          },
          "response": []
        }
      ],
      "description": "Endpoints for administrative management of appointments"
    },
    {
      "name": "Therapist-Specific Endpoints",
      "item": [
        {
          "name": "Get Therapist's Appointments",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{therapistToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/appointments/therapist/{{therapistId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "therapist", "{{therapistId}}"]
            },
            "description": "Get all appointments for a specific therapist"
          },
          "response": []
        },
        {
          "name": "Get Therapist's Today Appointments",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{therapistToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/appointments/therapist/{{therapistId}}?startDate={{today}}&endDate={{today}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "therapist", "{{therapistId}}"],
              "query": [
                {
                  "key": "startDate",
                  "value": "{{today}}"
                },
                {
                  "key": "endDate",
                  "value": "{{today}}"
                }
              ]
            },
            "description": "Get today's appointments for a specific therapist"
          },
          "response": []
        },
        {
          "name": "Update Appointment (Therapist)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{therapistToken}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n    \"notes\": \"Therapist notes from the session\",\n    \"status\": \"completed\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/appointments/{{appointmentId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "{{appointmentId}}"]
            },
            "description": "Update an appointment as a therapist (limited fields)"
          },
          "response": []
        }
      ],
      "description": "Endpoints specific to therapist operations"
    },
    {
      "name": "Patient-Related Endpoints",
      "item": [
        {
          "name": "Get Patient's Appointments",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/appointments/patient/{{patientId}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "patient", "{{patientId}}"]
            },
            "description": "Get all appointments for a specific patient"
          },
          "response": []
        },
        {
          "name": "Get Patient's Upcoming Appointments",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{adminToken}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/appointments/patient/{{patientId}}?status=scheduled&startDate={{today}}",
              "host": ["{{baseUrl}}"],
              "path": ["api", "appointments", "patient", "{{patientId}}"],
              "query": [
                {
                  "key": "status",
                  "value": "scheduled"
                },
                {
                  "key": "startDate",
                  "value": "{{today}}"
                }
              ]
            },
            "description": "Get upcoming appointments for a specific patient"
          },
          "response": []
        }
      ],
      "description": "Endpoints related to patient appointments"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Set today's date in YYYY-MM-DD format for use in requests",
          "const today = new Date();",
          "pm.environment.set('today', today.toISOString().split('T')[0]);"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [""]
      }
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:5000",
      "type": "string"
    },
    {
      "key": "appointmentId",
      "value": "",
      "type": "string"
    },
    {
      "key": "publicAppointmentId",
      "value": "",
      "type": "string"
    },
    {
      "key": "therapistId",
      "value": "",
      "type": "string"
    },
    {
      "key": "patientId",
      "value": "",
      "type": "string"
    },
    {
      "key": "serviceId",
      "value": "",
      "type": "string"
    }
  ]
}
